{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{{ tipo.nombre }} - {% trans "Todo Informática" %}{% endblock %}

{% block content %}
  
  <div class="d-flex align-items-center justify-content-between mb-4 animate-fade-up">
      <div>
        <a href="{% url 'index_tipoProducto' %}" class="btn btn-outline-secondary btn-sm mb-2">
            <i class="bi bi-arrow-left"></i> {% trans "Volver a Categorías" %}
        </a>
        <h1 class="display-5 fw-bold text-primary">
            {% blocktrans with nombre_tipo=tipo.nombre %}{{ nombre_tipo }}{% endblocktrans %}
        </h1>
        <p class="text-muted">{% trans "Explora los mejores productos de esta sección." %}</p>
      </div>
      
      <div class="d-none d-md-block opacity-25">
          <i class="bi {{ tipo.get_icon }} display-1"></i>
      </div>
  </div>

  <hr class="mb-5 opacity-10">

  {% if productos %}
    <div class="row row-cols-1 row-cols-md-2 g-4">
      {% for producto in productos %}
        <div class="col">
          <div class="card h-100 shadow-sm border-0">
            
            <div style="height: 250px; overflow: hidden;" class="position-relative bg-white rounded-top p-3 d-flex align-items-center justify-content-center">
                {% if producto.imagen %}
                  <img src="{{ producto.imagen.url }}" class="img-fluid" style="max-height: 100%; object-fit: contain;" alt="{{ producto.nombre }}">
                {% else %}
                  <img src="{% static 'images/no-image.png' %}" class="img-fluid opacity-50" style="max-height: 100%; object-fit: contain;" alt="Sin imagen">
                {% endif %}
                
                <span class="position-absolute bottom-0 end-0 badge bg-primary m-3 fs-6 shadow-sm">
                    {{ producto.precio_base }} €
                </span>
            </div>

            <div class="card-body d-flex flex-column bg-light bg-opacity-10">
              <h5 class="card-title fw-bold">{{ producto.nombre }}</h5>
              
              <p class="card-text text-muted small flex-grow-1">
                {{ producto.descripcion|truncatewords:15 }}
              </p>
              
              <div class="mt-3 pt-3 border-top">
                <a href="{% url 'producto' producto.id %}" class="btn btn-outline-dark w-100">
                    {% trans "Ver detalles" %} <i class="bi bi-arrow-right ms-1"></i>
                </a>
              </div>
            </div>

          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center py-5">
        <div class="mb-3">
            <i class="bi bi-inbox display-1 text-muted opacity-25"></i>
        </div>
        <h3 class="h4 text-muted">{% trans "No hay productos en esta categoría aún." %}</h3>
        <p class="mb-4">{% trans "Estamos reponiendo stock. ¡Vuelve pronto!" %}</p>
        <a href="{% url 'index_tipoProducto' %}" class="btn btn-primary">
            {% trans "Explorar otras categorías" %}
        </a>
    </div>
  {% endif %}

{% endblock %}